<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown-UI React Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .demo-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .event-log {
            background: #1a1a1a;
            color: #00ff00;
            padding: 1rem;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            font-size: 0.875rem;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
        }
        
        .markdown-source {
            background: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 0.875rem;
            white-space: pre-wrap;
        }
    </style>
    
    <!-- Import the CSS for widgets -->
    <link rel="stylesheet" href="../src/lib/widgets.css">
    
    <!-- Include React, ReactDOM, and Marked from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <h1>üéØ Markdown-UI React Demo</h1>
    <p>This demo shows React components rendering from markdown using custom elements.</p>
    
    <div class="demo-section">
        <h2>üìù Text Input Widget</h2>
        <div class="markdown-source">```markdown-ui-widget
{
  "type": "textInput",
  "label": "Your Name",
  "placeholder": "Enter your full name",
  "default": "John Doe"
}
```</div>
        <div id="demo-text-input"></div>
    </div>
    
    <div class="demo-section">
        <h2>üîò Button Group Widget</h2>
        <div class="markdown-source">```markdown-ui-widget
{
  "type": "buttonGroup",
  "label": "Choose your favorite framework",
  "choices": ["React", "Vue", "Svelte", "Angular"],
  "default": "React"
}
```</div>
        <div id="demo-button-group"></div>
    </div>
    
    <div class="demo-section">
        <h2>üìã Select Widget</h2>
        <div class="markdown-source">```markdown-ui-widget
{
  "type": "select",
  "label": "Select your country",
  "choices": ["United States", "Canada", "United Kingdom", "Germany", "Japan"],
  "default": "United States"
}
```</div>
        <div id="demo-select"></div>
    </div>
    
    <div class="demo-section">
        <h2>‚òëÔ∏è Multi-Select Widget</h2>
        <div class="markdown-source">```markdown-ui-widget
{
  "type": "selectMulti",
  "label": "Select programming languages you know",
  "choices": ["JavaScript", "TypeScript", "Python", "Go", "Rust", "Java"],
  "default": ["JavaScript", "TypeScript"]
}
```</div>
        <div id="demo-select-multi"></div>
    </div>
    
    <div class="demo-section">
        <h2>üéöÔ∏è Slider Widget</h2>
        <div class="markdown-source">```markdown-ui-widget
{
  "type": "slider",
  "label": "Rate your experience (1-10)",
  "min": 1,
  "max": 10,
  "step": 1,
  "default": 7
}
```</div>
        <div id="demo-slider"></div>
    </div>
    
    <div class="demo-section">
        <h2>üìä Complete Form Widget</h2>
        <div class="markdown-source">```markdown-ui-widget
{
  "type": "form",
  "submitLabel": "Submit Survey",
  "fields": [
    {
      "type": "textInput",
      "id": "name",
      "label": "Full Name",
      "placeholder": "Enter your name"
    },
    {
      "type": "select",
      "id": "experience",
      "label": "Years of Experience",
      "choices": ["0-1 years", "2-5 years", "6-10 years", "10+ years"]
    },
    {
      "type": "slider",
      "id": "satisfaction",
      "label": "Satisfaction Level",
      "min": 1,
      "max": 5,
      "default": 3
    }
  ]
}
```</div>
        <div id="demo-form"></div>
    </div>
    
    <div class="demo-section">
        <h2>üì° Event Log</h2>
        <p>Widget events will appear here in real-time:</p>
        <div id="event-log" class="event-log">Waiting for widget events...</div>
    </div>

    <!-- Load our React components as ES modules -->
    <script type="module">
        // Import our built components
        import { MarkdownUI } from '../dist/index.js';
        
        // Mock the marked extension functionality for demo
        const markedUiExtension = {
            renderer: {
                code(token) {
                    const lang = token.lang;
                    if (lang === "markdown-ui-widget") {
                        const payload = btoa(token.text);
                        const id = 'widget-' + Math.random().toString(36).substr(2, 9);
                        return `<markdown-ui-widget id="${id}" content="${payload}"></markdown-ui-widget>\n`;
                    }
                    return false;
                }
            }
        };
        
        // Configure marked with our extension
        marked.use(markedUiExtension);
        
        // Event logging
        const eventLog = document.getElementById('event-log');
        function logEvent(data) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] Widget "${data.id}" changed: ${JSON.stringify(data.value)}\n`;
            eventLog.textContent = logEntry + eventLog.textContent;
        }
        
        // Helper function to render markdown content
        function renderDemo(containerId, markdownContent) {
            const container = document.getElementById(containerId);
            const html = marked.parse(markdownContent);
            
            // Create React element and render
            const element = React.createElement(MarkdownUI, {
                html: html,
                onWidgetEvent: logEvent
            });
            
            const root = ReactDOM.createRoot(container);
            root.render(element);
        }
        
        // Render all demos
        renderDemo('demo-text-input', `
\`\`\`markdown-ui-widget
{
  "type": "textInput",
  "label": "Your Name",
  "placeholder": "Enter your full name",
  "default": "John Doe"
}
\`\`\`
        `);
        
        renderDemo('demo-button-group', `
\`\`\`markdown-ui-widget
{
  "type": "buttonGroup",
  "label": "Choose your favorite framework",
  "choices": ["React", "Vue", "Svelte", "Angular"],
  "default": "React"
}
\`\`\`
        `);
        
        renderDemo('demo-select', `
\`\`\`markdown-ui-widget
{
  "type": "select",
  "label": "Select your country",
  "choices": ["United States", "Canada", "United Kingdom", "Germany", "Japan"],
  "default": "United States"
}
\`\`\`
        `);
        
        renderDemo('demo-select-multi', `
\`\`\`markdown-ui-widget
{
  "type": "selectMulti",
  "label": "Select programming languages you know",
  "choices": ["JavaScript", "TypeScript", "Python", "Go", "Rust", "Java"],
  "default": ["JavaScript", "TypeScript"]
}
\`\`\`
        `);
        
        renderDemo('demo-slider', `
\`\`\`markdown-ui-widget
{
  "type": "slider",
  "label": "Rate your experience (1-10)",
  "min": 1,
  "max": 10,
  "step": 1,
  "default": 7
}
\`\`\`
        `);
        
        renderDemo('demo-form', `
\`\`\`markdown-ui-widget
{
  "type": "form",
  "submitLabel": "Submit Survey",
  "fields": [
    {
      "type": "textInput",
      "id": "name",
      "label": "Full Name",
      "placeholder": "Enter your name"
    },
    {
      "type": "select",
      "id": "experience",
      "label": "Years of Experience",
      "choices": ["0-1 years", "2-5 years", "6-10 years", "10+ years"]
    },
    {
      "type": "slider",
      "id": "satisfaction",
      "label": "Satisfaction Level",
      "min": 1,
      "max": 5,
      "default": 3
    }
  ]
}
\`\`\`
        `);
        
        console.log('Demo loaded successfully!');
    </script>
</body>
</html>